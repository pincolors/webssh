{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.dom-exception.stack.js\";\nimport { checkSSH } from '@/api/common';\nimport { Terminal } from 'xterm';\nimport { FitAddon } from 'xterm-addon-fit';\nimport { AttachAddon } from 'xterm-addon-attach';\nimport FileList from '@/components/FileList';\n// 引入 xterm 样式\nimport 'xterm/css/xterm.css';\nexport default {\n  name: 'Terminal',\n  components: {\n    FileList\n  },\n  data() {\n    return {\n      term: null,\n      ws: null,\n      resetClose: false,\n      ssh: null,\n      savePass: false,\n      fontSize: 15,\n      isSftpVisible: false,\n      fitAddon: null\n    };\n  },\n  mounted() {\n    this.$nextTick(() => {\n      this.createTerm();\n      window.addEventListener('resize', this.onWindowResize);\n    });\n  },\n  beforeUnmount() {\n    this.close();\n    window.removeEventListener('resize', this.onWindowResize);\n  },\n  methods: {\n    toggleSftpPanel() {\n      this.isSftpVisible = !this.isSftpVisible;\n      setTimeout(() => {\n        if (this.fitAddon) {\n          try {\n            this.fitAddon.fit();\n          } catch (e) {\n            console.warn(e);\n          }\n        }\n      }, 300);\n    },\n    onWindowResize() {\n      if (this.fitAddon) {\n        try {\n          this.fitAddon.fit();\n        } catch (e) {/**/}\n      }\n      if (this.ws && this.ws.readyState === 1 && this.term) {\n        this.ws.send(`resize:${this.term.rows}:${this.term.cols}`);\n      }\n    },\n    createTerm() {\n      const sshInfo = this.$store.state.sshInfo;\n      if (!sshInfo || !sshInfo.hostname) {\n        this.$message.error('无效的连接信息！正在返回登录页...');\n        this.$router.push('/');\n        return;\n      }\n      const termContainer = this.$refs.terminalRef;\n      if (!termContainer) {\n        console.error('Terminal container not found.');\n        return;\n      }\n\n      // --- ⚠️ 修改开始：获取原始字符串 ---\n      const rawSshReq = this.$store.getters.sshReq;\n      // --- ⚠️ 修改结束 ---\n\n      this.close();\n      const prefix = process.env.NODE_ENV === 'production' ? '' : '/api';\n      this.fitAddon = new FitAddon();\n      this.term = new Terminal({\n        cursorBlink: true,\n        cursorStyle: 'bar',\n        cursorWidth: 2,\n        fontFamily: 'Menlo, Monaco, \"Courier New\", monospace',\n        fontSize: this.fontSize,\n        theme: {\n          background: '#000000',\n          foreground: '#ffffff',\n          cursor: '#ffffff',\n          selection: '#daffe77a'\n        }\n      });\n      this.term.loadAddon(this.fitAddon);\n      this.term.open(termContainer);\n      this.term.focus();\n      try {\n        this.fitAddon.fit();\n      } catch (e) {/**/}\n      this.term.write('\\x1b[1;1H\\x1b[1;32m正在连接 ' + sshInfo.hostname + '...\\x1b[0m\\r\\n');\n      const self = this;\n      const heartCheck = {\n        timeout: 5000,\n        intervalObj: null,\n        stop: function () {\n          if (this.intervalObj) clearInterval(this.intervalObj);\n        },\n        start: function () {\n          this.intervalObj = setInterval(function () {\n            if (self.ws !== null && self.ws.readyState === 1) {\n              self.ws.send('ping');\n            }\n          }, this.timeout);\n        }\n      };\n      let closeTip = '已超时关闭!';\n      if (this.$store.state.language === 'en') {\n        closeTip = 'Connection timed out!';\n      }\n\n      // --- ⚠️ 核心修复开始：Base64 加密连接信息 ---\n      // 1. 将 sshReq (例如 user@ip:port) 转为 Base64\n      // 2. 使用 encodeURIComponent 防止 URL 中的特殊字符 (+, /, =) 出错\n      const encodedSshInfo = encodeURIComponent(window.btoa(rawSshReq));\n      const protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n\n      // 使用加密后的 encodedSshInfo 替换原来的 sshReq\n      const wsUrl = `${protocol}://${location.host}${prefix}/term?sshInfo=${encodedSshInfo}&rows=${this.term.rows}&cols=${this.term.cols}&closeTip=${closeTip}`;\n      console.log('WS URL:', wsUrl); // 调试用，能在控制台看到是否加密成功\n      // --- ⚠️ 核心修复结束 ---\n\n      this.ws = new WebSocket(wsUrl);\n      this.ws.onopen = () => {\n        console.log('WebSocket Connected');\n        self.connected();\n        heartCheck.start();\n        self._initCmdSent = false;\n        setTimeout(() => {\n          try {\n            self.fitAddon.fit();\n          } catch (e) {/**/}\n        }, 100);\n      };\n      this.ws.onmessage = event => {\n        if (typeof event.data === 'string') {\n          setTimeout(() => {\n            if (!self._initCmdSent && self.ssh) {\n              const term = self.term;\n              if (!term || !term.buffer || !term.buffer.active) return;\n              const currentLineNumber = term.buffer.active.baseY + term.buffer.active.cursorY;\n              const line = term.buffer.active.getLine(currentLineNumber);\n              if (line) {\n                const lineText = line.translateToString();\n                if (/[>$#%]\\s*$/.test(lineText.trimEnd())) {\n                  self._initCmdSent = true;\n                  self.term.write('\\x1b[s\\x1b[1;1H\\x1b[2K\\x1b[u');\n                  if (self.ssh.command) {\n                    setTimeout(() => {\n                      if (self.ws && self.ws.readyState === 1) {\n                        self.ws.send(self.ssh.command + '\\r');\n                      }\n                    }, 100);\n                  }\n                }\n              }\n            }\n          }, 10);\n        }\n      };\n      this.ws.onclose = () => {\n        if (!self.resetClose) {\n          if (self.ssh && !this.savePass) {\n            this.$store.commit('SET_PASS', '');\n            if (self.ssh) self.ssh.password = '';\n          }\n          this.$message({\n            message: this.$t ? this.$t('wsClose') : '连接已断开',\n            type: 'warning',\n            duration: 3000,\n            showClose: true\n          });\n          this.ws = null;\n        }\n        heartCheck.stop();\n        self.resetClose = false;\n      };\n      this.ws.onerror = e => {\n        console.error('WS Error:', e);\n      };\n      const attachAddon = new AttachAddon(this.ws, {\n        bidirectional: false\n      });\n      this.term.loadAddon(attachAddon);\n      this.term.onData(data => {\n        if (self.ws && self.ws.readyState === 1) {\n          self.ws.send(data);\n        }\n      });\n      termContainer.addEventListener('wheel', e => {\n        if (e.ctrlKey) {\n          e.preventDefault();\n          if (e.deltaY < 0) {\n            self.fontSize++;\n          } else {\n            self.fontSize = Math.max(10, self.fontSize - 1);\n          }\n          self.term.setOption('fontSize', self.fontSize);\n          try {\n            self.fitAddon.fit();\n          } catch (e) {/**/}\n        }\n      }, {\n        passive: false\n      });\n    },\n    async connected() {\n      const sshInfo = this.$store.state.sshInfo;\n      this.ssh = Object.assign({}, sshInfo);\n      try {\n        const result = await checkSSH(this.$store.getters.sshReq);\n        if (result.Msg !== 'success') {\n          return;\n        } else {\n          this.savePass = result.Data.savePass;\n        }\n      } catch (e) {\n        console.error(e);\n      }\n      document.title = sshInfo.hostname || 'WebSSH';\n      let sshList = this.$store.state.sshList;\n      if (sshList === null) {\n        // 这里其实可以简化，省略处理历史记录的逻辑\n      } else {\n        // ... (保留原有逻辑)\n      }\n      // 注意：这里为了安全，不建议在这里直接把密码写入历史记录，除非你知道自己在做什么\n    },\n    close() {\n      if (this.ws !== null) {\n        this.ws.close();\n        this.resetClose = true;\n      }\n      if (this.term !== null) {\n        this.term.dispose();\n        this.term = null;\n      }\n    }\n  }\n};","map":{"version":3,"names":["checkSSH","Terminal","FitAddon","AttachAddon","FileList","name","components","data","term","ws","resetClose","ssh","savePass","fontSize","isSftpVisible","fitAddon","mounted","$nextTick","createTerm","window","addEventListener","onWindowResize","beforeUnmount","close","removeEventListener","methods","toggleSftpPanel","setTimeout","fit","e","console","warn","readyState","send","rows","cols","sshInfo","$store","state","hostname","$message","error","$router","push","termContainer","$refs","terminalRef","rawSshReq","getters","sshReq","prefix","process","env","NODE_ENV","cursorBlink","cursorStyle","cursorWidth","fontFamily","theme","background","foreground","cursor","selection","loadAddon","open","focus","write","self","heartCheck","timeout","intervalObj","stop","clearInterval","start","setInterval","closeTip","language","encodedSshInfo","encodeURIComponent","btoa","protocol","location","wsUrl","host","log","WebSocket","onopen","connected","_initCmdSent","onmessage","event","buffer","active","currentLineNumber","baseY","cursorY","line","getLine","lineText","translateToString","test","trimEnd","command","onclose","commit","password","message","$t","type","duration","showClose","onerror","attachAddon","bidirectional","onData","ctrlKey","preventDefault","deltaY","Math","max","setOption","passive","Object","assign","result","Msg","Data","document","title","sshList","dispose"],"sources":["C:\\Users\\Adam\\Desktop\\wssh\\webssh\\frontend\\src\\components\\Terminal.vue"],"sourcesContent":["<template>\r\n  <div class=\"terminal-page-wrapper\">\r\n    <div class=\"terminal-page-container\">\r\n      <div class=\"terminal-area\">\r\n        <div ref=\"terminalRef\" class=\"xterm-container\"></div>\r\n      </div>\r\n      <div class=\"file-tree\" :class=\"{ 'is-visible': isSftpVisible }\">\r\n        <FileList />\r\n      </div>\r\n    </div>\r\n    <div class=\"terminal-footer\">\r\n      <a href=\"https://github.com/adamj001/webssh-lw\" target=\"_blank\" class=\"github-link\" title=\"GitHub\">\r\n        <i class=\"fab fa-github\"></i>\r\n      </a>\r\n      <button @click=\"toggleSftpPanel\" class=\"sftp-toggle-btn\" title=\"文件管理\">\r\n        <i class=\"fas fa-folder-open\" style=\"margin-left: 15px;\"></i>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { checkSSH } from '@/api/common'\r\nimport { Terminal } from 'xterm'\r\nimport { FitAddon } from 'xterm-addon-fit'\r\nimport { AttachAddon } from 'xterm-addon-attach'\r\nimport FileList from '@/components/FileList'\r\n// 引入 xterm 样式\r\nimport 'xterm/css/xterm.css' \r\n\r\nexport default {\r\n    name: 'Terminal',\r\n    components: { FileList },\r\n    data() {\r\n        return {\r\n            term: null,\r\n            ws: null,\r\n            resetClose: false,\r\n            ssh: null,\r\n            savePass: false,\r\n            fontSize: 15,\r\n            isSftpVisible: false,\r\n            fitAddon: null\r\n        }\r\n    },\r\n    mounted() {\r\n        this.$nextTick(() => {\r\n            this.createTerm()\r\n            window.addEventListener('resize', this.onWindowResize)\r\n        })\r\n    },\r\n    beforeUnmount() {\r\n        this.close()\r\n        window.removeEventListener('resize', this.onWindowResize)\r\n    },\r\n    methods: {\r\n        toggleSftpPanel() {\r\n            this.isSftpVisible = !this.isSftpVisible\r\n            setTimeout(() => {\r\n                if (this.fitAddon) {\r\n                    try { this.fitAddon.fit() } catch (e) { console.warn(e) }\r\n                }\r\n            }, 300)\r\n        },\r\n        onWindowResize() {\r\n            if (this.fitAddon) {\r\n                try { this.fitAddon.fit() } catch (e) {/**/}\r\n            }\r\n            if (this.ws && this.ws.readyState === 1 && this.term) {\r\n                this.ws.send(`resize:${this.term.rows}:${this.term.cols}`)\r\n            }\r\n        },\r\n        createTerm() {\r\n            const sshInfo = this.$store.state.sshInfo;\r\n            if (!sshInfo || !sshInfo.hostname) {\r\n                this.$message.error('无效的连接信息！正在返回登录页...')\r\n                this.$router.push('/')\r\n                return\r\n            }\r\n\r\n            const termContainer = this.$refs.terminalRef\r\n            if (!termContainer) {\r\n                console.error('Terminal container not found.')\r\n                return\r\n            }\r\n\r\n            // --- ⚠️ 修改开始：获取原始字符串 ---\r\n            const rawSshReq = this.$store.getters.sshReq\r\n            // --- ⚠️ 修改结束 ---\r\n\r\n            this.close()\r\n            const prefix = process.env.NODE_ENV === 'production' ? '' : '/api'\r\n            \r\n            this.fitAddon = new FitAddon()\r\n            this.term = new Terminal({\r\n                cursorBlink: true,\r\n                cursorStyle: 'bar',\r\n                cursorWidth: 2,\r\n                fontFamily: 'Menlo, Monaco, \"Courier New\", monospace',\r\n                fontSize: this.fontSize,\r\n                theme: {\r\n                    background: '#000000',\r\n                    foreground: '#ffffff',\r\n                    cursor: '#ffffff',\r\n                    selection: '#daffe77a',\r\n                }\r\n            })\r\n\r\n            this.term.loadAddon(this.fitAddon)\r\n            this.term.open(termContainer)\r\n            this.term.focus()\r\n            \r\n            try { this.fitAddon.fit() } catch (e) {/**/}\r\n\r\n            this.term.write('\\x1b[1;1H\\x1b[1;32m正在连接 ' + sshInfo.hostname + '...\\x1b[0m\\r\\n')\r\n\r\n            const self = this\r\n            const heartCheck = {\r\n                timeout: 5000,\r\n                intervalObj: null,\r\n                stop: function() {\r\n                    if (this.intervalObj) clearInterval(this.intervalObj)\r\n                },\r\n                start: function() {\r\n                    this.intervalObj = setInterval(function() {\r\n                        if (self.ws !== null && self.ws.readyState === 1) {\r\n                            self.ws.send('ping')\r\n                        }\r\n                    }, this.timeout)\r\n                }\r\n            }\r\n\r\n            let closeTip = '已超时关闭!'\r\n            if (this.$store.state.language === 'en') {\r\n                closeTip = 'Connection timed out!'\r\n            }\r\n\r\n            // --- ⚠️ 核心修复开始：Base64 加密连接信息 ---\r\n            // 1. 将 sshReq (例如 user@ip:port) 转为 Base64\r\n            // 2. 使用 encodeURIComponent 防止 URL 中的特殊字符 (+, /, =) 出错\r\n            const encodedSshInfo = encodeURIComponent(window.btoa(rawSshReq))\r\n            \r\n            const protocol = location.protocol === 'https:' ? 'wss' : 'ws'\r\n            \r\n            // 使用加密后的 encodedSshInfo 替换原来的 sshReq\r\n            const wsUrl = `${protocol}://${location.host}${prefix}/term?sshInfo=${encodedSshInfo}&rows=${this.term.rows}&cols=${this.term.cols}&closeTip=${closeTip}`\r\n            \r\n            console.log('WS URL:', wsUrl) // 调试用，能在控制台看到是否加密成功\r\n            // --- ⚠️ 核心修复结束 ---\r\n            \r\n            this.ws = new WebSocket(wsUrl)\r\n\r\n            this.ws.onopen = () => {\r\n                console.log('WebSocket Connected')\r\n                self.connected()\r\n                heartCheck.start()\r\n                self._initCmdSent = false\r\n                setTimeout(() => {\r\n                     try { self.fitAddon.fit() } catch (e) {/**/}\r\n                }, 100)\r\n            }\r\n\r\n            this.ws.onmessage = (event) => {\r\n                if (typeof event.data === 'string') {\r\n                    setTimeout(() => {\r\n                        if (!self._initCmdSent && self.ssh) {\r\n                            const term = self.term;\r\n                            if (!term || !term.buffer || !term.buffer.active) return;\r\n                            const currentLineNumber = term.buffer.active.baseY + term.buffer.active.cursorY;\r\n                            const line = term.buffer.active.getLine(currentLineNumber);\r\n                            if (line) {\r\n                                const lineText = line.translateToString();\r\n                                if (/[>$#%]\\s*$/.test(lineText.trimEnd())) {\r\n                                    self._initCmdSent = true;\r\n                                    self.term.write('\\x1b[s\\x1b[1;1H\\x1b[2K\\x1b[u');\r\n                                    if (self.ssh.command) {\r\n                                        setTimeout(() => {\r\n                                            if (self.ws && self.ws.readyState === 1) {\r\n                                                self.ws.send(self.ssh.command + '\\r');\r\n                                            }\r\n                                        }, 100);\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }, 10);\r\n                }\r\n            }\r\n\r\n            this.ws.onclose = () => {\r\n                if (!self.resetClose) {\r\n                    if (self.ssh && !this.savePass) {\r\n                        this.$store.commit('SET_PASS', '')\r\n                        if (self.ssh) self.ssh.password = ''\r\n                    }\r\n                    this.$message({\r\n                        message: this.$t ? this.$t('wsClose') : '连接已断开',\r\n                        type: 'warning',\r\n                        duration: 3000,\r\n                        showClose: true\r\n                    })\r\n                    this.ws = null\r\n                }\r\n                heartCheck.stop()\r\n                self.resetClose = false\r\n            }\r\n\r\n            this.ws.onerror = (e) => {\r\n                console.error('WS Error:', e)\r\n            }\r\n\r\n            const attachAddon = new AttachAddon(this.ws, { bidirectional: false })\r\n            this.term.loadAddon(attachAddon)\r\n\r\n            this.term.onData(data => {\r\n                if (self.ws && self.ws.readyState === 1) {\r\n                    self.ws.send(data)\r\n                }\r\n            })\r\n\r\n            termContainer.addEventListener('wheel', (e) => {\r\n                if (e.ctrlKey) {\r\n                    e.preventDefault()\r\n                    if (e.deltaY < 0) {\r\n                        self.fontSize++\r\n                    } else {\r\n                        self.fontSize = Math.max(10, self.fontSize - 1)\r\n                    }\r\n                    self.term.setOption('fontSize', self.fontSize)\r\n                    try { self.fitAddon.fit() } catch (e) {/**/}\r\n                }\r\n            }, { passive: false })\r\n        },\r\n        async connected() {\r\n            const sshInfo = this.$store.state.sshInfo\r\n            this.ssh = Object.assign({}, sshInfo)\r\n            try {\r\n                const result = await checkSSH(this.$store.getters.sshReq)\r\n                if (result.Msg !== 'success') {\r\n                    return\r\n                } else {\r\n                    this.savePass = result.Data.savePass\r\n                }\r\n            } catch(e) {\r\n                console.error(e)\r\n            }\r\n            \r\n            document.title = sshInfo.hostname || 'WebSSH'\r\n            \r\n            let sshList = this.$store.state.sshList\r\n            if (sshList === null) {\r\n                // 这里其实可以简化，省略处理历史记录的逻辑\r\n            } else {\r\n                // ... (保留原有逻辑)\r\n            }\r\n            // 注意：这里为了安全，不建议在这里直接把密码写入历史记录，除非你知道自己在做什么\r\n        },\r\n        close() {\r\n            if (this.ws !== null) {\r\n                this.ws.close()\r\n                this.resetClose = true\r\n            }\r\n            if (this.term !== null) {\r\n                this.term.dispose()\r\n                this.term = null\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.terminal-page-wrapper {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  width: 100%;\r\n  background: #000;\r\n  box-shadow: var(--shadow);\r\n  overflow: hidden;\r\n}\r\n\r\n.terminal-page-container {\r\n  display: flex;\r\n  flex: 1;\r\n  min-height: 0;\r\n  overflow: hidden;\r\n  position: relative;\r\n}\r\n\r\n.terminal-area {\r\n  flex: 1;\r\n  min-width: 0;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  background-color: black;\r\n}\r\n\r\n.xterm-container {\r\n  flex: 1;\r\n  width: 100%;\r\n  height: 100%;\r\n  padding-left: 5px;\r\n  overflow: hidden;\r\n}\r\n\r\n.file-tree {\r\n  width: 350px;\r\n  border-left: 1px solid var(--input-border);\r\n  background: var(--input-bg);\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.terminal-footer {\r\n  width: 100%;\r\n  text-align: center;\r\n  padding: 5px 0;\r\n  font-size: 15px;\r\n  color: #ccc;\r\n  background: #1a1a1a;\r\n  border-top: 1px solid #333;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  gap: 8px;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.github-link {\r\n  color: #ccc;\r\n  margin-left: 4px;\r\n  font-size: 18px;\r\n}\r\n\r\n.sftp-toggle-btn {\r\n  display: none;\r\n  background: none;\r\n  border: none;\r\n  color: #ccc;\r\n  font-size: 18px;\r\n  cursor: pointer;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .sftp-toggle-btn {\r\n    display: inline-block;\r\n  }\r\n  .file-tree {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    width: 85%;\r\n    transform: translateX(100%);\r\n    transition: transform 0.3s ease-in-out;\r\n    z-index: 20;\r\n  }\r\n  .file-tree.is-visible {\r\n    transform: translateX(0);\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}